(()=>{var e={};e.id=510,e.ids=[510],e.modules={4665:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=4665,e.exports=t},1185:e=>{"use strict";e.exports=require("mongoose")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},8893:e=>{"use strict";e.exports=require("buffer")},1282:e=>{"use strict";e.exports=require("child_process")},4770:e=>{"use strict";e.exports=require("crypto")},665:e=>{"use strict";e.exports=require("dns")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},5807:e=>{"use strict";e.exports=require("module")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},8220:e=>{"use strict";e.exports=require("stream")},4026:e=>{"use strict";e.exports=require("string_decoder")},2452:e=>{"use strict";e.exports=require("tls")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},8032:(e,t,s)=>{"use strict";s.r(t),s.d(t,{originalPathname:()=>q,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>x,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f});var r={};s.r(r),s.d(r,{PATCH:()=>l});var i=s(9303),o=s(8716),n=s(670),u=s(2021),a=s(2880),p=s(4335),c=s(7070),d=s(5150);async function l(e){await (0,u.u)();let{tvId:t}=await e.json(),s=await a.TV.findById(t).populate("currentSessionId");if(!s||!s.currentSessionId)return c.NextResponse.json({message:"Active session not found"},{status:404});await d.p.remove(t),await (0,p.X3)(s.ipAddress),await (0,p.bT)(s.ipAddress);let r=s.currentSessionId;return r.status="Ended",await r.save(),s.status="Idle",s.currentSessionId=null,await s.save(),c.NextResponse.json({message:"Session stopped"})}let x=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/session/stop/route",pathname:"/api/session/stop",filename:"route",bundlePath:"app/api/session/stop/route"},resolvedPagePath:"/Users/figar_jr/project/android-tv-timer/app/api/session/stop/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:v}=x,q="/api/session/stop/route";function y(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}},4335:(e,t,s)=>{"use strict";s.d(t,{Ig:()=>a,X3:()=>u,bT:()=>p});var r=s(1764),i=s.n(r),o=s(1282);let n=i().promisify(o.exec);async function u(e){await n(`adb connect ${e}`)}async function a(e){await n(`adb -s ${e}:5555 shell input keyevent 224`),await n(`adb -s ${e}:5555 shell input keyevent 178`),await n(`adb -s ${e}:5555 shell input keyevent 23`)}async function p(e){await n(`adb -s ${e}:5555 shell input keyevent 3`)}},2021:(e,t,s)=>{"use strict";s.d(t,{u:()=>n});var r=s(1185),i=s.n(r);let o=!1;async function n(){if(!o)try{await i().connect(process.env.MONGODB_URI||"mongodb://localhost:27017/tv_timer_prod"),o=!0,console.log("MongoDB connected")}catch(e){throw console.error("MongoDB connection error:",e),e}}},5150:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var r=s(6608),i=s(2197);let o=new(s.n(i)())({maxRetriesPerRequest:null}),n=new r.ci("powerOffTV",{connection:o})},2880:(e,t,s)=>{"use strict";s.d(t,{TV:()=>n});var r=s(1185),i=s.n(r);let o=new r.Schema({name:{type:String,required:!0},ipAddress:{type:String,required:!0},offlineCount:{type:Number,default:0},status:{type:String,enum:["Idle","Active","Offline","Ended"],default:"Idle"},currentSessionId:{type:i().Schema.Types.ObjectId,ref:"Session"},psType:{type:String,required:!0}},{timestamps:!0}),n=i().models.TV||i().model("TV",o)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,972,608],()=>s(8032));module.exports=r})();